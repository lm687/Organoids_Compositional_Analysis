ch2 <- ComplexHeatmap::Heatmap(cor_CN_genes_of_interest_clade[[2]], cluster_columns = F, cluster_rows = F,
cell_fun = function(j, i, x, y, w, h, col) { # add text to each grid
grid.text(round(cor_CN_genes_of_interest_clade[[2]][i, j], 1), x, y)
}, column_title = as.character(unique(dendrograminputclr))[2])
ch3 <- ComplexHeatmap::Heatmap(cor_CN_genes_of_interest_clade[[3]],
cell_fun = function(j, i, x, y, w, h, col) { # add text to each grid
grid.text(round(cor_CN_genes_of_interest_clade[[2]][i, j], 1), x, y)
})
ch1+ch2
plot(as.vector(cor_CN_genes_of_interest_clade[[1]]), as.vector(cor_CN_genes_of_interest_clade[[2]]))
abline(coef = c(0,1), lty='dashed')
## correlation of the most variable genes
cor_CN_genes_most_var <- cor(t(all_cn[order(var_all_cn, decreasing = T)[1:100],]))
ComplexHeatmap::Heatmap(cor_CN_genes_most_var)
ggplot(melt(all_cn_subset_GoI['MYC',]), aes(x=value))+geom_density()+#geom_vline(xintercept = all_cn_subset_GoI['MYC',1])
geom_segment(aes(x = value, xend=value, y=-Inf, yend=Inf), alpha=0.2)+theme_bw()+scale_x_continuous(trans = "log2")
umap_genes_GoI <- umap(t(all_cn_subset_GoI))
df_umap_selectedgenes <- cbind.data.frame(umap_genes_GoI$layout,
sample=colnames(all_cn_var),
clade=as.character(dendrograminputclr[match(colnames(all_cn_var), names(dendrograminputclr))]),
MYC=unlist(all_cn_var['MYC',]),
BRCA1=unlist(all_cn_var['BRCA1',]),
BRCA2=unlist(all_cn_var['BRCA2',])
)
ggplot(df_umap_selectedgenes,
aes(x=`1`, y=`2`, label=sample))+
geom_point( alpha=0.2, aes( color=clade, size=BRCA1))+
theme_bw()
umap_genes2 <- umap((all_cn_subset_GoI))
plot(umap_genes$layout)
plot(umap_genes2$layout) ## ??? looks very weird
give_umap_per_chrom <- function(chrom){
dta <- t(all_cn_var[ag_subsetchrom$seq_name == chrom,])
dta <- dta[,!grepl("NA.", colnames(dta))]
na_idx <- which(colnames(dta) == "NA")
if(length(na_idx)>0)  dta <- dta[,-na_idx]
if(!is.null(dim(dta))){
.umap_res <- umap(dta)
return(cbind.data.frame(.umap_res$layout,
sample=colnames(all_cn_var),
clade=as.character(dendrograminputclr[match(colnames(all_cn_var), names(dendrograminputclr))]),
MYC=unlist(all_cn_var['MYC',]),
BRCA1=unlist(all_cn_var['BRCA1',]),
BRCA2=unlist(all_cn_var['BRCA2',]))
)
}else{
NA
}
}
pdf("figures/umap_segments_per_chrom.pdf", width = 4.2, height = 3)
sapply(gtools::mixedsort(unique(ag_subsetchrom$seq_name)), function(chrom_it){
.umap <-  give_umap_per_chrom(chrom_it)
cat('Chromosome ', chrom_it, '\n')
if(!is.na(.umap)){
print(ggplot(.umap,
aes(x=`1`, y=`2`, label=sample))+
geom_point( alpha=0.2, aes( color=clade, size=MYC))+
theme_bw()+ggtitle(paste0('Chromosome ', chrom_it)))
}else{
print(ggplot()+ggtitle(paste0('Chromosome ', chrom_it)))
}
})
dev.off()
system("open figures")
##----- multiple regression to see which genes determine the two classes
# cor_CN_genes_of_interest_clade <- lapply(as.character(unique(dendrograminputclr)), function(clade_lab){
#   cor(remove_cols_with_no_variance(
all_cn_var_clades <- all_cn_var[,!(is.na(dendrograminputclr))]
dendrograminputclr_no_na <- dendrograminputclr[!(is.na(dendrograminputclr))]
dim(all_cn_var_clades)
length(dendrograminputclr_no_na)
all_cn_var_clades_df <- (data.frame( dendrograminputclr_no_na, t(all_cn_var_clades)))
all_cn_var_clades_df[1:4,1:4]
all_cn_var_clades_df$dendrograminputclr_no_na <- factor(all_cn_var_clades_df$dendrograminputclr_no_na)
all_cn_var_clades_df_bin <- cbind.data.frame(dendrograminputclr_no_na=all_cn_var_clades_df[,1], apply(all_cn_var_clades_df[,-1], 2, function(i) as.numeric(i<2)))
dim(all_cn_var_clades_df)
dim(all_cn_var_clades_df_bin)
data_for_SVM <- all_cn_var_clades_df
data_for_SVM <- all_cn_var_clades_df_bin
dendrograminputclr_no_na
training_set_idx <- sample(1:nrow(data_for_SVM), size = floor(.7*nrow(data_for_SVM)))
training_set = data_for_SVM[training_set_idx,]
validation_set = data_for_SVM[!(1:nrow(data_for_SVM) %in% training_set_idx),]
library(e1071)
library(caret)
var_genes <- apply(training_set, 2, var)
subset_cols <- c(1, order(var_genes[-1], decreasing = T)[1:1000]) ## selecting the top X most variable genes #1:ncol(training_set)
length(subset_cols)
svmfit = svm(dendrograminputclr_no_na ~ ., data = training_set[,subset_cols], kernel = "linear", cost = 10, scale = FALSE)
print(svmfit)
# pheatmap::pheatmap(svmfit$SV)
# pheatmap::pheatmap(svmfit$coef0)
validation_predicted = predict(svmfit, validation_set[,subset_cols])
confusionMatrix(validation_predicted, validation_set$dendrograminputclr_no_na)
dim(svmfit$coefs)
dim(svmfit$SV)
order_coefs_svm <- order(svmfit$coefs, decreasing = T)
order_coefs_svm
colnames(training_set)
ggplot(all_cn_var_clades_df[,c('dendrograminputclr_no_na', 'MYC')], aes(x=dendrograminputclr_no_na, y = MYC))+
geom_boxplot()+geom_jitter()+scale_y_continuous(trans = "log2")+theme_bw()
ggplot(all_cn_var_clades_df[,c('dendrograminputclr_no_na', 'CCNE1')], aes(x=dendrograminputclr_no_na, y = CCNE1))+
geom_boxplot()+geom_jitter()+scale_y_continuous(trans = "log2")+theme_bw()
ggplot(all_cn_var_clades_df[,c('dendrograminputclr_no_na', 'CDKN2D')], aes(x=dendrograminputclr_no_na, y = CDKN2D))+
geom_boxplot()+geom_jitter()+scale_y_continuous(trans = "log2")+theme_bw()
## ttest between the two groups
idx_s3 <- (all_cn_var_clades_df$dendrograminputclr_no_na == "S3-rich")
idx_s4 <- (all_cn_var_clades_df$dendrograminputclr_no_na == "S4-rich")
ttests_between_groups <- sapply(2:ncol(all_cn_var_clades_df), function(gene_idx){
t.test(all_cn_var_clades_df[idx_s3,gene_idx], all_cn_var_clades_df[idx_s4,gene_idx])
})
ttests_between_groups[,1]
dim(ttests_between_groups)
## pval
order_pval_ttest <- order(unlist(ttests_between_groups[3,]))
order_pval_ttest
colnames(all_cn_var_clades_df)[-1][order_pval_ttest[1:100]]
plot(unlist(ttests_between_groups[1,]),
-log10(unlist(ttests_between_groups[3,]))) ## volcano plot
genes_ttest_clades <- cbind.data.frame(tstat=unlist(ttests_between_groups[1,]),
minlogpval=-log10(unlist(ttests_between_groups[3,])),
minlogpvaladj=-log10(p.adjust(unlist(ttests_between_groups[3,]))),
gene=colnames(all_cn_var_clades_df)[-1],
chrom=ag$seq_name[match(genes_ttest_clades$gene, ag$gene_name)])
ggplot(genes_ttest_clades, aes(x=factor(chrom, level=gtools::mixedsort(unique(chrom))), y=minlogpvaladj))+
geom_boxplot()+geom_jitter(alpha=0.2)+theme_bw()+
geom_hline(yintercept = -log10(0.05), lty='dashed', col='blue')
head(melt(all_cn_var, measure.vars = NULL))
all_cn_var_df <- (melt(as(all_cn_var, 'matrix')))
all_cn_var_df$chrom=ag$seq_name[match(all_cn_var_df$Var1, ag$gene_name)]
# ggplot(all_cn_var_df, aes(x=factor(chrom, level=gtools::mixedsort(unique(chrom))), ## too large
#                                   y=value))+geom_boxplot()+geom_jitter(alpha=0.2)+theme_bw()
all_cn_var_df$clade <- dendrograminputclr[match(all_cn_var_df$Var2, names(dendrograminputclr))]
dim(all_cn_var_df)
all_cn_var_df_summary <- all_cn_var_df %>% dplyr::group_by(Var1) %>% dplyr::summarise(mean_val=mean(value))
all_cn_var_df_summary2 <- all_cn_var_df %>% dplyr::group_by(Var1, clade) %>% dplyr::summarise(mean_val=mean(value))
dim(all_cn_var_df_summary)
all_cn_var_df_summary$chrom=ag$seq_name[match(all_cn_var_df_summary$Var1, ag$gene_name)]
all_cn_var_df_summary2$chrom=ag$seq_name[match(all_cn_var_df_summary2$Var1, ag$gene_name)]
ggplot(all_cn_var_df_summary, aes(x=as.numeric(chrom), group=chrom,
y=mean_val, label=ifelse(mean_val<1.5, as.character(Var1), NA)))+
geom_boxplot()+geom_jitter(alpha=0.2, width = 0.2)+geom_label_repel(nudge_x = 0)+theme_bw()
all_cn_var_df_summary2[is.na(all_cn_var_df_summary2$chrom),]
ggplot(all_cn_var_df_summary2[!is.na(all_cn_var_df_summary2$chrom),],
aes(x=clade, group=clade, col=clade,
y=mean_val, label=ifelse(mean_val<1.5, as.character(Var1), NA)))+
# geom_boxplot()+
facet_wrap(.~as.numeric(chrom), scales = "free_x")+
geom_jitter(alpha=0.2, width = 0.2, aes(group=interaction(chrom, clade)))+
# geom_label_repel(nudge_x = 0)+
theme_bw()+labs(x='Clade and chromosome', y='Absolute CN')
ggsave("figures/average_CN_genes_per_chrom.pdf", width = 10, height = 10)
all_cn_var_df_summary2
# umap_genes <- umap((all_cn_var))
# plot(umap_genes$layout)
# plot(umap_genes$layout, xlim(-100, 100))
# plot(umap_genes$layout, xlim = c(-20, 20),  ylim = c(-20, 20), pch=19, cex=0.1) ## not very interesting
## primary and relapse
## read in relapse/primary information
load("../../../other_repos/britroc-1/data/britroc_30kb_signature_data.rds")
patient.meta
df_umap_britroc_rel_arx <- df_umap
df_umap_britroc_rel_arx$group = patient.meta$group[match(df_umap$sample, patient.meta$SAMPLE_ID)]
df_umap_britroc_rel_arx$ploidy = patient.meta$ploidy[match(df_umap$sample, patient.meta$SAMPLE_ID)]
df_umap_britroc_rel_arx$patient = patient.meta$PATIENT_ID[match(df_umap$sample, patient.meta$SAMPLE_ID)]
patients_both_samples <- unique(df_umap_britroc_rel_arx$patient)[which(sapply(unique(df_umap_britroc_rel_arx$patient), function(i) all(c('arx', 'rlps') %in% df_umap_britroc_rel_arx$group[df_umap_britroc_rel_arx$patient == i])))]
patients_both_samples <- patients_both_samples[!is.na(patients_both_samples)]
df_umap_britroc_rel_arx$patient_only_matched <- ifelse( (df_umap_britroc_rel_arx$patient %in% patients_both_samples),
yes = as.character(df_umap_britroc_rel_arx$patient),
no=NA)
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, shape=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient, col=gsub('BRITROC-', 'BR', as.character(patient))))+
# geom_label_repel(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
#                  aes(x=`1`, y=`2`, col=patient, group=patient, label=patient_only_matched), alpha=0.8,
#                  max.overlaps = 10, size=2)+
# theme(legend.position = "bottom", )+
labs(col='', shape='')+guides(col=guide_legend(ncol=1))
ggsave("figures/umap_britroc_arx_rlps.pdf", width = 6, height = 6)
df_umap[which.max(df_umap$`1`),]
df_umap[(df_umap_britroc_rel_arx$`1`)>50,]
df_umap[(df_umap$`1`)>100,]
all_cn_var[,'JBLAB-4264PS']
all_cn_var[,'JBLAB-4264']
dim(df_umap_britroc_rel_arx)
df_umap_britroc_rel_arx
df_umap_britroc_rel_arx$patient_only_matched
df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),]
dim(df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),])
sapply(unique(df_umap_britroc_rel_arx$patient), function(i){
all(c('arx', 'rlps') %in% df_umap_britroc_rel_arx$group[df_umap_britroc_rel_arx$patient == i])
})
sapply(unique(patient.meta$patient), function(i){
all(c('arx', 'rlps') %in% patient.meta$group[patient.meta$patient == i])
})
patient.meta$patient
sapply(unique(patient.meta$PATIENT_ID), function(i){
all(c('arx', 'rlps') %in% patient.meta$group[patient.meta$PATIENT_ID == i])
})
table(sapply(unique(patient.meta$PATIENT_ID), function(i){
all(c('arx', 'rlps') %in% patient.meta$group[patient.meta$PATIENT_ID == i])
}))
table(sapply(unique(df_umap_britroc_rel_arx$patient), function(i){
all(c('arx', 'rlps') %in% df_umap_britroc_rel_arx$group[df_umap_britroc_rel_arx$patient == i])
}))
df_umap$sample
df_umap_britroc_rel_arx <- df_umap
df_umap_britroc_rel_arx$group = patient.meta$group[match(paste0(df_umap$sample, 'PS'), patient.meta$SAMPLE_ID)]
table(df_umap_britroc_rel_arx$group)
df_umap_britroc_rel_arx$group = patient.meta$group[match(gsub('PS', '', df_umap$sample), patient.meta$SAMPLE_ID)]
df_umap_britroc_rel_arx
df_umap_britroc_rel_arx$sample
table(grepl("*PS$", df_umap_britroc_rel_arx$sample))
df_umap_britroc_rel_arx <- df_umap
df_umap_britroc_rel_arx <- df_umap_britroc_rel_arx[(grepl("*PS$", df_umap_britroc_rel_arx$sample)),]
df_umap_britroc_rel_arx$group = patient.meta$group[match(gsub('PS', '', df_umap$sample), patient.meta$SAMPLE_ID)]
df_umap_britroc_rel_arx <- df_umap
df_umap_britroc_rel_arx <- df_umap_britroc_rel_arx[(grepl("*PS$", df_umap_britroc_rel_arx$sample)),]
df_umap_britroc_rel_arx$group = patient.meta$group[match(gsub('PS', '', df_umap_britroc_rel_arx$sample), patient.meta$SAMPLE_ID)]
df_umap_britroc_rel_arx <- df_umap
df_umap_britroc_rel_arx <- df_umap_britroc_rel_arx[(grepl("*PS$", df_umap_britroc_rel_arx$sample)),]
df_umap_britroc_rel_arx$group = patient.meta$group[match(gsub('PS', '', df_umap_britroc_rel_arx$sample), patient.meta$SAMPLE_ID)]
df_umap_britroc_rel_arx$ploidy = patient.meta$ploidy[match(gsub('PS', '', df_umap$sample), patient.meta$SAMPLE_ID)]
df_umap_britroc_rel_arx <- df_umap
df_umap_britroc_rel_arx <- df_umap_britroc_rel_arx[(grepl("*PS$", df_umap_britroc_rel_arx$sample)),]
df_umap_britroc_rel_arx$group = patient.meta$group[match(gsub('PS', '', df_umap_britroc_rel_arx$sample), patient.meta$SAMPLE_ID)]
df_umap_britroc_rel_arx$ploidy = patient.meta$ploidy[match(gsub('PS', '', df_umap_britroc_rel_arx$sample), patient.meta$SAMPLE_ID)]
df_umap_britroc_rel_arx$patient = patient.meta$PATIENT_ID[match(gsub('PS', '', df_umap_britroc_rel_arx$sample), patient.meta$SAMPLE_ID)]
patients_both_samples <- unique(df_umap_britroc_rel_arx$patient)[which(sapply(unique(df_umap_britroc_rel_arx$patient), function(i) all(c('arx', 'rlps') %in% df_umap_britroc_rel_arx$group[df_umap_britroc_rel_arx$patient == i])))]
patients_both_samples <- patients_both_samples[!is.na(patients_both_samples)]
df_umap_britroc_rel_arx$patient_only_matched <- ifelse( (df_umap_britroc_rel_arx$patient %in% patients_both_samples),
yes = as.character(df_umap_britroc_rel_arx$patient),
no=NA)
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, shape=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient, col=gsub('BRITROC-', 'BR', as.character(patient))))+
# geom_label_repel(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
#                  aes(x=`1`, y=`2`, col=patient, group=patient, label=patient_only_matched), alpha=0.8,
#                  max.overlaps = 10, size=2)+
# theme(legend.position = "bottom", )+
labs(col='', shape='')+guides(col=guide_legend(ncol=1))
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, shape=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient, col=gsub('BRITROC-', 'BR', as.character(patient))))+
# geom_label_repel(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
#                  aes(x=`1`, y=`2`, col=patient, group=patient, label=patient_only_matched), alpha=0.8,
#                  max.overlaps = 10, size=2)+
# theme(legend.position = "bottom", )+
labs(col='', shape='')+guides(col=guide_legend(ncol=2))
ggsave("figures/umap_britroc_arx_rlps.pdf", width = 6, height = 6)
dim(df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),])
table(sapply(unique(df_umap_britroc_rel_arx$patient), function(i){
all(c('arx', 'rlps') %in% df_umap_britroc_rel_arx$group[df_umap_britroc_rel_arx$patient == i])
}))
table(sapply(unique(patient.meta$PATIENT_ID), function(i){
all(c('arx', 'rlps') %in% patient.meta$group[patient.meta$PATIENT_ID == i])
}))
df_umap[which.max(df_umap$`1`),]
df_umap[(df_umap_britroc_rel_arx$`1`)>50,]
df_umap[(df_umap$`1`)>100,]
all_cn_var[,'JBLAB-4264PS']
all_cn_var[,'JBLAB-4264']
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, shape=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient, col=gsub('BRITROC-', 'BR', as.character(patient))))+
# geom_label_repel(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
#                  aes(x=`1`, y=`2`, col=patient, group=patient, label=patient_only_matched), alpha=0.8,
#                  max.overlaps = 10, size=2)+
# theme(legend.position = "bottom", )+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
ggsave("figures/umap_britroc_arx_rlps.pdf", width = 6.5, height = 6)
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, shape=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient, col=gsub('BRITROC-', 'BR', as.character(patient))))+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, shape=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient ))+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`, col=group), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, shape=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient ))+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, shape=group, col=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient ))+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, col=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient ))+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
ggsave("figures/umap_britroc_arx_rlps_2.pdf", width = 6.5, height = 6)
?geom_line
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, col=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient ), arrow = arrow())+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
ggsave("figures/umap_britroc_arx_rlps_2.pdf", width = 6.5, height = 6)
?arrow
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, col=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient ), arrow = arrow(size=1))+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
ggsave("figures/umap_britroc_arx_rlps_2.pdf", width = 6.5, height = 6)
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, col=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient ), arrow = arrow(length=unit(0.30,"cm")))+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
ggsave("figures/umap_britroc_arx_rlps_2.pdf", width = 6.5, height = 6)
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, col=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient ), arrow = arrow(length=unit(0.15,"cm")))+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
ggsave("figures/umap_britroc_arx_rlps_2.pdf", width = 6.5, height = 6)
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, col=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient ), arrow = arrow(length=unit(0.15,"cm"), ends="first"))+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
ggsave("figures/umap_britroc_arx_rlps_2.pdf", width = 6.5, height = 6)
df_umap_britroc_rel_arx$group
df_umap_britroc_rel_arx$group <- factor(df_umap_britroc_rel_arx$group)
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, col=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient ), arrow = arrow(length=unit(0.15,"cm"), ends="first"))+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
ggsave("figures/umap_britroc_arx_rlps_2.pdf", width = 6.5, height = 6)
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, col=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient ), arrow = arrow(length=unit(0.15,"cm"), colour=c('red', 'green')[group], ends="first"))+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, col=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient ), arrow = arrow(length=unit(0.15,"cm")), colour=c('red', 'green')[group]))+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, col=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient ), arrow = arrow(length=unit(0.15,"cm")), colour=c('red', 'green')[group])+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, col=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient, colour=c('red', 'green')[group] ), arrow = arrow(length=unit(0.15,"cm")))+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
ggsave("figures/umap_britroc_arx_rlps_2.pdf", width = 6.5, height = 6)
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, col=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient, colour=group ), arrow = arrow(length=unit(0.15,"cm")))+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
ggsave("figures/umap_britroc_arx_rlps_2.pdf", width = 6.5, height = 6)
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, shape=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient, colour=group ), arrow = arrow(length=unit(0.15,"cm")))+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
ggsave("figures/umap_britroc_arx_rlps_2.pdf", width = 6.5, height = 6)
df_umap_britroc_rel_arx$group <- factor(df_umap_britroc_rel_arx$group, levels=c('rlps', 'arx'))
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, shape=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient, colour=group ), arrow = arrow(length=unit(0.15,"cm")))+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
ggsave("figures/umap_britroc_arx_rlps_2.pdf", width = 6.5, height = 6)
df_umap_britroc_rel_arx$group <- factor(df_umap_britroc_rel_arx$group)
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, shape=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient, colour=group ), arrow = arrow(length=unit(0.15,"cm", end='last')))+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, shape=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient, colour=group ), arrow = arrow(length=unit(0.15,"cm", end='second')))+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, shape=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient, colour=group ), arrow = arrow(length=unit(0.15,"cm", end='first')))+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, shape=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient, colour=group ), arrow = arrow(length=unit(0.15,"cm", ends='last')))+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, shape=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient, colour=group ), arrow = arrow(length=unit(0.15,"cm", ends='second')))+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, shape=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient, colour=group ), arrow = arrow(length=unit(0.15,"cm", ends='first')))+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, shape=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient), arrow = arrow(length=unit(0.15,"cm", ends='first')))+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
?arrow
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, shape=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient, colour=group ), arrow = arrow(length=unit(0.15,"cm"), ends="last"))+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
ggsave("figures/umap_britroc_arx_rlps_2.pdf", width = 6.5, height = 6)
df_umap_britroc_rel_arx$group
df_umap_britroc_rel_arx$group <- factor(df_umap_britroc_rel_arx$group)
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, shape=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient, colour=group ), arrow = arrow(length=unit(0.15,"cm"), ends="last"))+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
ggsave("figures/umap_britroc_arx_rlps_2.pdf", width = 6.5, height = 6)
df_umap_britroc_rel_arx$group
df_umap_britroc_rel_arx$group <- factor(df_umap_britroc_rel_arx$group, levels=c('arx', 'rlps'))
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, shape=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient, colour=group ), arrow = arrow(length=unit(0.15,"cm"), ends="last"))+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
ggsave("figures/umap_britroc_arx_rlps_2.pdf", width = 6.5, height = 6)
ggplot()+
geom_point(data = df_umap, aes(x=`1`, y=`2`), alpha=0.02, size=5)+
geom_point(data = df_umap_britroc_rel_arx, aes(x=`1`, y=`2`, shape=group))+
theme_bw()+
geom_line(data = df_umap_britroc_rel_arx[!is.na(df_umap_britroc_rel_arx$patient_only_matched),],
aes(x=`1`, y=`2`,group=patient, colour=group ), arrow = arrow(length=unit(0.15,"cm"), ends="first"))+
labs(col='', shape='')+guides(col=guide_legend(ncol=3))
ggsave("figures/umap_britroc_arx_rlps_2.pdf", width = 6.5, height = 6)
