aes(x=counts.Var2, y=PDO, col=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
(CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_color_manual(values=c('red', 'orange', 'blue', 'black'))+theme_bw()+
geom_text(col='black', size=4)+guides(col=F, size=F)
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO, col=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
(CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_color_manual(values=c('red', 'orange', 'blue', 'black'))+theme_bw()
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO, fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
(CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_color_manual(values=c('red', 'orange', 'blue', 'black'))+theme_bw()
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO, fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
(CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('red', 'orange', 'blue', 'black'))+theme_bw()
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO, fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
(CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('red', 'orange', 'blue', 'black'))+theme_bw()
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO, fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
(CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('red', 'orange', 'blue', 'black'))+theme_bw()+
geom_text(col='black', size=4)+guides(col=F, size=F)
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(CN.value, breaks = c(1, 2, 3, 5, 50))+
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('red', 'orange', 'blue', 'black'))+theme_bw()+
geom_text(col='black', size=4)+guides(col=F, size=F)
cut(joint_counts_CN0$CN.value[1:10], breaks = c(1, 2, 3, 5, 50)
)
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(CN.value, breaks = c(1, 2, 3, 5, 50))+
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
# scale_fill_manual(values=c('red', 'orange', 'blue', 'black'))+theme_bw()+
geom_text(col='black', size=4)+guides(col=F, size=F)
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(CN.value, breaks = c(1, 2, 3, 5, 50))+
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
# scale_fill_manual(values=c('red', 'orange', 'blue', 'black'))+theme_bw()+
geom_text(col='black', size=4)+guides(fill=F, size=F)
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(CN.value, breaks = c(1, 2, 3, 5, 50))+
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(CN.value, breaks = c(1, 2, 3, 5, 50)),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
# scale_fill_manual(values=c('red', 'orange', 'blue', 'black'))+theme_bw()+
geom_text(col='black', size=4)+guides(fill=F, size=F)
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(CN.value, breaks = c(1, 2, 3, 5, 50)),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('red', 'orange', 'blue', 'black'))+theme_bw()+
geom_text(col='black', size=4)+guides(fill=F, size=F)
round(3.3, 1)
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(1, 2, 3, 5, 50)),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('white', 'blue', 'yellow', 'orange',  'red'))+theme_bw()+
geom_text(col='black', size=4)+guides(fill=F, size=F)
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(1, 2, 3, 5, 50)),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'yellow', 'orange',  'red'))+theme_bw()+
geom_text(col='black', size=4)+guides(fill=F, size=F)
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(1, 2, 3, 5, 50)),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red'))+theme_bw()+
geom_text(col='black', size=4)+guides(fill=F, size=F)
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(0, 1, 2, 3, 5, 50)),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red'))+theme_bw()+
geom_text(col='black', size=4)+guides(fill=F, size=F)
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(0, 1, 2, 3, 5, 50)),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red', 'purple'))+theme_bw()+
geom_text(col='black', size=4)+guides(fill=F, size=F)
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(0, 1, 2, 3, 5, 150)),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red', 'purple'))+theme_bw()+
geom_text(col='black', size=4)+guides(fill=F, size=F)
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(0, 1, 2, 3, 5, 50, 150)),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red', 'purple'))+theme_bw()+
geom_text(col='black', size=4)+guides(fill=F, size=F)
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(0, 1, 2, 3, 5, 50, 150)),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red', 'purple'))+theme_bw()+
geom_text(col='black', size=4)+guides(fill=F, size=F)+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))+
ggsave("../../figures_GRCh37/genes_of_interest_CN_tile.pdf", width = 5, height = 4)
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(0, 1, 2, 3, 5, 50, 150)),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red', 'purple'))+theme_bw()+
geom_text(col='black', size=4)+guides(fill=F, size=F)+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))
ggsave("../../figures_GRCh37/genes_of_interest_CN_tile.pdf", width = 5, height = 4)
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(0, 1, 2, 3, 5, 50, 150)),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red', 'purple'))+theme_bw()+
geom_text(col='black', size=4)+guides(fill=F, size=F)+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))+labs(x='Genes', y='PDO')
ggsave("../../figures_GRCh37/genes_of_interest_CN_tile.pdf", width = 5, height = 4)
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(0, 1, 2, 3, 5, 50, 150)),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red', 'purple'))+theme_bw()+
geom_text(col='black', size=4)+guides(fill=F, size=F)+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))+labs(x='Genes', y='PDO')
ggsave("../../figures_GRCh37/genes_of_interest_CN_tile.pdf", width = 6, height = 5)
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(0, 1, 2, 3, 5, 50, 150)),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red', 'purple'))+theme_bw()+
geom_text(col='black', size=3)+guides(fill=F, size=F)+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))+labs(x='Genes', y='PDO')
ggsave("../../figures_GRCh37/genes_of_interest_CN_tile.pdf", width = 6, height = 5)
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(0, 1, 2, 3, 5, 50, 150)),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red', 'purple'))+theme_bw()+
geom_text(col='black', size=3)+guides(fill=F, size=F)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+labs(x='Genes', y='PDO')
ggsave("../../figures_GRCh37/genes_of_interest_CN_tile.pdf", width = 6, height = 5)
ggsave("../../figures_GRCh37/genes_of_interest_CN_tile.pdf", width = 6.5, height = 5)
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(0, 1, 2, 3, 5, 50, 150)),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red', 'purple'))+theme_bw()+
geom_text(col='black', size=3)+guides(fill=F, size=F)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+labs(x='Genes', y='PDO')
ggsave("../../figures_GRCh37/genes_of_interest_CN_tile.pdf", width = 7, height = 5)
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(0, 1, 2, 3, 5, 50, 150)),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red', 'purple'))+theme_bw()+
geom_text(col='black', size=3)+guides(fill=F, size=F)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+labs(x='Genes', y='PDO')+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggsave("../../figures_GRCh37/genes_of_interest_CN_tile.pdf", width = 7, height = 5)
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(0, 1, 2, 3, 5, 50, 150)=0.2),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red', 'purple'))+theme_bw()+
geom_text(col='black', size=3)+guides(fill=F, size=F)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+labs(x='Genes', y='PDO')+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(0, 1, 2, 3, 5, 50, 150)-0.2),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red', 'purple'))+theme_bw()+
geom_text(col='black', size=3)+guides(fill=F, size=F)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+labs(x='Genes', y='PDO')+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggsave("../../figures_GRCh37/genes_of_interest_CN_tile.pdf", width = 7, height = 5)
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(0, 1, 2, 3, 5, 50, 150)-0.1),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red', 'purple'))+theme_bw()+
geom_text(col='black', size=3)+guides(fill=F, size=F)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+labs(x='Genes', y='PDO')+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggsave("../../figures_GRCh37/genes_of_interest_CN_tile.pdf", width = 7, height = 5)
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(0, 1, 2, 3, 5, 50, 150)-0.6),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red', 'purple'))+theme_bw()+
geom_text(col='black', size=3)+guides(fill=F, size=F)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+labs(x='Genes', y='PDO')+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(0, 1, 2, 3, 5, 50, 150)-0.9),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red', 'purple'))+theme_bw()+
geom_text(col='black', size=3)+guides(fill=F, size=F)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+labs(x='Genes', y='PDO')+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(0, 1, 2, 3, 5, 50, 150)-0.2),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red', 'purple'))+theme_bw()+
geom_text(col='black', size=3)+guides(fill=F, size=F)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+labs(x='Genes', y='PDO')+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggsave("../../figures_GRCh37/genes_of_interest_CN_tile.pdf", width = 7, height = 5)
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(0, 1, 2, 2.1, 3, 5, 50, 150)-0.2),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red', 'purple'))+theme_bw()+
geom_text(col='black', size=3)+guides(fill=F, size=F)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+labs(x='Genes', y='PDO')+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(1, 2, 2.1, 3, 5, 50, 150)-0.2),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red', 'purple'))+theme_bw()+
geom_text(col='black', size=3)+guides(fill=F, size=F)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+labs(x='Genes', y='PDO')+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(1, 2, 2.1, 3, 5, 50, 150)),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red', 'purple'))+theme_bw()+
geom_text(col='black', size=3)+guides(fill=F, size=F)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+labs(x='Genes', y='PDO')+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(0, 1, 2, 2.1, 3, 5, 50, 150)),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red', 'purple', 'black'))+theme_bw()+
geom_text(col='black', size=3)+guides(fill=F, size=F)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+labs(x='Genes', y='PDO')+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(0, 1, 2, 2.1, 3, 5, 50, 150)=0.1),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red', 'purple', 'black'))+theme_bw()+
geom_text(col='black', size=3)+guides(fill=F, size=F)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+labs(x='Genes', y='PDO')+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(0, 1, 2, 2.1, 3, 5, 50, 150)-0.1),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red', 'purple', 'black'))+theme_bw()+
geom_text(col='black', size=3)+guides(fill=F, size=F)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+labs(x='Genes', y='PDO')+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(0, 1, 2, 2.1, 3, 5, 50, 150)+0.1),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red', 'purple', 'black'))+theme_bw()+
geom_text(col='black', size=3)+guides(fill=F, size=F)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+labs(x='Genes', y='PDO')+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(0, 2, 2.1, 3, 5, 50, 150)+0.1),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red', 'purple',))+theme_bw()+
geom_text(col='black', size=3)+guides(fill=F, size=F)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+labs(x='Genes', y='PDO')+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(0, 2, 2.1, 3, 5, 50, 150)+0.1),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red', 'purple'))+theme_bw()+
geom_text(col='black', size=3)+guides(fill=F, size=F)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+labs(x='Genes', y='PDO')+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(0, 1.9, 2.1, 3, 5, 50, 150)+0.1),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red', 'purple'))+theme_bw()+
geom_text(col='black', size=3)+guides(fill=F, size=F)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+labs(x='Genes', y='PDO')+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(0, 1.9, 2.1, 3, 5, 50, 150)),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red', 'purple'))+theme_bw()+
geom_text(col='black', size=3)+guides(fill=F, size=F)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+labs(x='Genes', y='PDO')+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggplot(joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest),
aes(x=counts.Var2, y=PDO,
# fill=paste0((CN.value==0), (CN.value>0 & CN.value<=1),
#                                  (CN.value>1 & CN.value<=2), CN.value>2), size=10*log(CN.value),
fill=cut(round(CN.value, 1), breaks = c(0, 1.9, 2.1, 3, 5, 50, 150)),
label=round(CN.value, 1)))+
geom_tile(alpha=0.2)+
scale_fill_manual(values=c('blue', 'white', 'yellow', 'orange',  'red', 'purple'))+theme_bw()+
geom_text(col='black', size=3)+guides(fill=F, size=F)+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))+labs(x='Genes', y='PDO')+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
ggsave("../../figures_GRCh37/genes_of_interest_CN_tile.pdf", width = 7, height = 5)
joint_counts_CN0
joint_counts_CN0 %>% filter(CN.gene_name %in% subset_genes_of_interest)
CN_genes_of_interest_mat
cor(CN_genes_of_interest_mat)
rownames(CN_genes_of_interest_mat) <- CN_genes_of_interest_mat$CN.gene_name
cor(CN_genes_of_interest_mat[,-1])
pheatmap::pheatmap(cor(CN_genes_of_interest_mat[,-1]))
pheatmap::pheatmap(cor(t(CN_genes_of_interest_mat[,-1])))
t(CN_genes_of_interest_mat[,-1])
pheatmap::pheatmap(cor(t(CN_genes_of_interest_mat[,-1])))
pheatmap::pheatmap(cor(t(CN_genes_of_interest_mat[,-1])), cluster_cols = F, cluster_rows = F)
CN_genes_of_interest_mat
CN_genes_of_interest_mat
(CN_genes_of_interest_mat
)
t(CN_genes_of_interest_mat)
apply(CN_genes_of_interest_mat, 1, as.numeric)
)t(CN_genes_of_interest_mat[,-1])
t(CN_genes_of_interest_mat[,-1])
apply(t(CN_genes_of_interest_mat[,-1]), 2, var)
t(CN_genes_of_interest_mat[,-1])[,!(apply(t(CN_genes_of_interest_mat[,-1]), 2, var) == 0)]
pheatmap::pheatmap(cor(remove_cols_with_no_variance(t(CN_genes_of_interest_mat[,-1])[,!(apply(t(CN_genes_of_interest_mat[,-1]), 2, var) == 0)])), cluster_cols = F, cluster_rows = F)
remove_cols_with_no_variance <- function(i)  t(i[,-1])[,!(apply(t(i[,-1]), 2, var) == 0)]
pheatmap::pheatmap(cor(remove_cols_with_no_variance(t(CN_genes_of_interest_mat[,-1]))), cluster_cols = F, cluster_rows = F)
pheatmap::pheatmap(cor(remove_cols_with_no_variance((CN_genes_of_interest_mat[,-1]))), cluster_cols = F, cluster_rows = F)
pheatmap::pheatmap(cor(remove_cols_with_no_variance((CN_genes_of_interest_mat[,-1]))),
cluster_cols = T, cluster_rows = T)
ComplexHeatmap::Heatmap(cor(remove_cols_with_no_variance((CN_genes_of_interest_mat[,-1]))))
pdf("../../figures_GRCh37/correlation_CN_genes_of_interest.pdf", width = 7)
ComplexHeatmap::Heatmap(cor(remove_cols_with_no_variance((CN_genes_of_interest_mat[,-1]))))
dev.off()
cor_CN_genes_of_interest <- cor(remove_cols_with_no_variance((CN_genes_of_interest_mat[,-1])))
grid.text(cor_CN_genes_of_interest[i, j], x, y)
ComplexHeatmap::Heatmap(cor_CN_genes_of_interest,
cell_fun = function(j, i, x, y, w, h, col) { # add text to each grid
grid.text(cor_CN_genes_of_interest[i, j], x, y)
})
library(gridExtra)
ComplexHeatmap::Heatmap(cor_CN_genes_of_interest,
cell_fun = function(j, i, x, y, w, h, col) { # add text to each grid
grid.text(cor_CN_genes_of_interest[i, j], x, y)
})
?grid.text
library(grid)
ComplexHeatmap::Heatmap(cor_CN_genes_of_interest,
cell_fun = function(j, i, x, y, w, h, col) { # add text to each grid
grid.text(cor_CN_genes_of_interest[i, j], x, y)
})
ComplexHeatmap::Heatmap(cor_CN_genes_of_interest,
cell_fun = function(j, i, x, y, w, h, col) { # add text to each grid
grid.text(round(cor_CN_genes_of_interest[i, j], 1), x, y)
})
pdf("../../figures_GRCh37/correlation_CN_genes_of_interest.pdf", width = 7)
ComplexHeatmap::Heatmap(cor_CN_genes_of_interest,
cell_fun = function(j, i, x, y, w, h, col) { # add text to each grid
grid.text(round(cor_CN_genes_of_interest[i, j], 1), x, y)
})
dev.off()
pdf("../../figures_GRCh37/correlation_CN_genes_of_interest.pdf", width = 8, height = 7.5)
ComplexHeatmap::Heatmap(cor_CN_genes_of_interest,
cell_fun = function(j, i, x, y, w, h, col) { # add text to each grid
grid.text(round(cor_CN_genes_of_interest[i, j], 1), x, y)
})
dev.off()
system("mkdir data/clean_segtables/")
